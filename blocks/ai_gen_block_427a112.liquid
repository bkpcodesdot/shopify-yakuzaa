{% doc %}
  @prompt
    Create a Shopify section called “Blog + Sticky Product Offer” with a 2-column layout.
    
    Left column (Blog Content):
    
    Supports multiple rich text blocks (headings, subheadings, paragraphs).
    
    Allow formatting (bold, italic, underline, highlight).
    
    Custom text colors (black, pink, grey).
    
    Ability to insert images between text blocks.
    
    Rich text editor should allow different colors per sentence.
    
    Right column (Sticky Product Offer):
    
    A product offer box that stays sticky/fixed while scrolling (desktop only, toggle ON/OFF).
    
    Includes:
    
    Custom heading (e.g., “Special Offer”)
    
    Product image (image picker)
    
    Product title (text)
    
    Bullet list of benefits (editable list)
    
    Pricing (original price, crossed price, sale price)
    
    Quantity selector (+ / –)
    
    Add to Cart button (links to product)
    
    Guarantee text or badges
    
    Shipping notice with countdown timer (editable).
    
    Customizer Options:
    
    Background color (default light pink).
    
    Border radius, padding, and margin controls.
    
    Text color controls (primary, secondary, highlight).
    
    Responsive behavior:
    
    Desktop → 2-column layout, right side sticky.
    
    Mobile → product box stacks below content, non-sticky.

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-blog-product-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: 1fr 350px;
    gap: 40px;
    max-width: 1200px;
    margin: 0 auto;
    padding: {{ block.settings.section_padding }}px;
  }

  .ai-blog-content-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .ai-blog-text-{{ ai_gen_id }} {
    line-height: 1.6;
    font-size: 16px;
  }

  .ai-blog-text-{{ ai_gen_id }} h1,
  .ai-blog-text-{{ ai_gen_id }} h2,
  .ai-blog-text-{{ ai_gen_id }} h3 {
    margin: 0 0 16px 0;
    line-height: 1.3;
  }

  .ai-blog-text-{{ ai_gen_id }} p {
    margin: 0 0 16px 0;
  }

  .ai-blog-text-{{ ai_gen_id }} .text-black {
    color: {{ block.settings.text_color_black }};
  }

  .ai-blog-text-{{ ai_gen_id }} .text-pink {
    color: {{ block.settings.text_color_pink }};
  }

  .ai-blog-text-{{ ai_gen_id }} .text-grey {
    color: {{ block.settings.text_color_grey }};
  }

  .ai-blog-image-{{ ai_gen_id }} {
    width: 100%;
    border-radius: {{ block.settings.image_border_radius }}px;
    margin: 16px 0;
  }

  .ai-blog-image-placeholder-{{ ai_gen_id }} {
    background-color: #f4f4f4;
    border-radius: {{ block.settings.image_border_radius }}px;
    margin: 16px 0;
    position: relative;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-blog-image-placeholder-{{ ai_gen_id }} svg {
    width: 100%;
    height: 100%;
    max-width: 200px;
    max-height: 200px;
  }

  .ai-product-offer-{{ ai_gen_id }} {
    background-color: {{ block.settings.offer_background_color }};
    border-radius: {{ block.settings.offer_border_radius }}px;
    padding: {{ block.settings.offer_padding }}px;
    margin: {{ block.settings.offer_margin }}px 0;
    height: fit-content;
  }

  {% if block.settings.sticky_enabled %}
    @media screen and (min-width: 990px) {
      .ai-product-offer-{{ ai_gen_id }} {
        position: sticky;
        top: 20px;
      }
    }
  {% endif %}

  .ai-offer-heading-{{ ai_gen_id }} {
    color: {{ block.settings.primary_text_color }};
    font-size: 24px;
    font-weight: bold;
    margin: 0 0 20px 0;
    text-align: center;
  }

  .ai-offer-image-{{ ai_gen_id }} {
    width: 100%;
    border-radius: 8px;
    margin-bottom: 16px;
  }

  .ai-offer-image-placeholder-{{ ai_gen_id }} {
    background-color: #f4f4f4;
    border-radius: 8px;
    margin-bottom: 16px;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .ai-offer-image-placeholder-{{ ai_gen_id }} svg {
    width: 100%;
    height: 100%;
    max-width: 150px;
    max-height: 150px;
  }

  .ai-offer-title-{{ ai_gen_id }} {
    color: {{ block.settings.primary_text_color }};
    font-size: 20px;
    font-weight: 600;
    margin: 0 0 16px 0;
  }

  .ai-offer-benefits-{{ ai_gen_id }} {
    margin: 16px 0;
  }

  .ai-offer-benefits-{{ ai_gen_id }} ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .ai-offer-benefits-{{ ai_gen_id }} li {
    color: {{ block.settings.secondary_text_color }};
    padding: 4px 0;
    position: relative;
    padding-left: 20px;
  }

  .ai-offer-benefits-{{ ai_gen_id }} li:before {
    content: "✓";
    color: {{ block.settings.highlight_color }};
    font-weight: bold;
    position: absolute;
    left: 0;
  }

  .ai-offer-pricing-{{ ai_gen_id }} {
    margin: 20px 0;
    text-align: center;
  }

  .ai-offer-original-price-{{ ai_gen_id }} {
    color: {{ block.settings.secondary_text_color }};
    text-decoration: line-through;
    font-size: 16px;
    margin-right: 8px;
  }

  .ai-offer-sale-price-{{ ai_gen_id }} {
    color: {{ block.settings.highlight_color }};
    font-size: 24px;
    font-weight: bold;
  }

  .ai-offer-quantity-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin: 20px 0;
  }

  .ai-quantity-button-{{ ai_gen_id }} {
    width: 32px;
    height: 32px;
    border: 1px solid {{ block.settings.secondary_text_color }};
    background: white;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }

  .ai-quantity-input-{{ ai_gen_id }} {
    width: 60px;
    text-align: center;
    border: 1px solid {{ block.settings.secondary_text_color }};
    border-radius: 4px;
    padding: 8px;
  }

  .ai-offer-button-{{ ai_gen_id }} {
    width: 100%;
    background-color: {{ block.settings.highlight_color }};
    color: white;
    border: none;
    border-radius: 8px;
    padding: 16px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    margin: 20px 0;
    text-decoration: none;
    display: block;
    text-align: center;
  }

  .ai-offer-button-{{ ai_gen_id }}:hover {
    opacity: 0.9;
  }

  .ai-offer-guarantee-{{ ai_gen_id }} {
    color: {{ block.settings.secondary_text_color }};
    font-size: 14px;
    text-align: center;
    margin: 16px 0;
  }

  .ai-offer-shipping-{{ ai_gen_id }} {
    background-color: rgba(255, 255, 255, 0.5);
    border-radius: 6px;
    padding: 12px;
    text-align: center;
    margin: 16px 0;
  }

  .ai-countdown-{{ ai_gen_id }} {
    color: {{ block.settings.highlight_color }};
    font-weight: bold;
    font-size: 18px;
  }

  @media screen and (max-width: 989px) {
    .ai-blog-product-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
      gap: 30px;
    }

    .ai-product-offer-{{ ai_gen_id }} {
      order: 2;
      position: static !important;
    }

    .ai-blog-content-{{ ai_gen_id }} {
      order: 1;
    }
  }
{% endstyle %}

<div class="ai-blog-product-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-blog-content-{{ ai_gen_id }}">
    {% if block.settings.blog_text_1 != blank %}
      <div class="ai-blog-text-{{ ai_gen_id }}">{{ block.settings.blog_text_1 }}</div>
    {% endif %}

    {% if block.settings.blog_image_1 %}
      <img
        src="{{ block.settings.blog_image_1 | image_url: width: 800 }}"
        alt="{{ block.settings.blog_image_1.alt | escape }}"
        class="ai-blog-image-{{ ai_gen_id }}"
        loading="lazy"
      >
    {% elsif block.settings.blog_text_1 != blank %}
      <div class="ai-blog-image-placeholder-{{ ai_gen_id }}">
        {{ 'image' | placeholder_svg_tag }}
      </div>
    {% endif %}

    {% if block.settings.blog_text_2 != blank %}
      <div class="ai-blog-text-{{ ai_gen_id }}">{{ block.settings.blog_text_2 }}</div>
    {% endif %}

    {% if block.settings.blog_image_2 %}
      <img
        src="{{ block.settings.blog_image_2 | image_url: width: 800 }}"
        alt="{{ block.settings.blog_image_2.alt | escape }}"
        class="ai-blog-image-{{ ai_gen_id }}"
        loading="lazy"
      >
    {% elsif block.settings.blog_text_2 != blank %}
      <div class="ai-blog-image-placeholder-{{ ai_gen_id }}">
        {{ 'image' | placeholder_svg_tag }}
      </div>
    {% endif %}

    {% if block.settings.blog_text_3 != blank %}
      <div class="ai-blog-text-{{ ai_gen_id }}">{{ block.settings.blog_text_3 }}</div>
    {% endif %}

    {% if block.settings.blog_image_3 %}
      <img
        src="{{ block.settings.blog_image_3 | image_url: width: 800 }}"
        alt="{{ block.settings.blog_image_3.alt | escape }}"
        class="ai-blog-image-{{ ai_gen_id }}"
        loading="lazy"
      >
    {% elsif block.settings.blog_text_3 != blank %}
      <div class="ai-blog-image-placeholder-{{ ai_gen_id }}">
        {{ 'image' | placeholder_svg_tag }}
      </div>
    {% endif %}
  </div>

  <div class="ai-product-offer-{{ ai_gen_id }}">
    {% if block.settings.offer_heading != blank %}
      <h2 class="ai-offer-heading-{{ ai_gen_id }}">{{ block.settings.offer_heading }}</h2>
    {% endif %}

    {% if block.settings.product_image %}
      <img
        src="{{ block.settings.product_image | image_url: width: 400 }}"
        alt="{{ block.settings.product_image.alt | escape }}"
        class="ai-offer-image-{{ ai_gen_id }}"
        loading="lazy"
      >
    {% else %}
      <div class="ai-offer-image-placeholder-{{ ai_gen_id }}">
        {{ 'product-apparel-1' | placeholder_svg_tag }}
      </div>
    {% endif %}

    {% if block.settings.product_title != blank %}
      <h3 class="ai-offer-title-{{ ai_gen_id }}">{{ block.settings.product_title }}</h3>
    {% endif %}

    {% if block.settings.benefits_list != blank %}
      <div class="ai-offer-benefits-{{ ai_gen_id }}">
        {{ block.settings.benefits_list }}
      </div>
    {% endif %}

    <div class="ai-offer-pricing-{{ ai_gen_id }}">
      {% if block.settings.original_price != blank %}
        <span class="ai-offer-original-price-{{ ai_gen_id }}">{{ block.settings.original_price }}</span>
      {% endif %}
      {% if block.settings.sale_price != blank %}
        <span class="ai-offer-sale-price-{{ ai_gen_id }}">{{ block.settings.sale_price }}</span>
      {% endif %}
    </div>

    <div class="ai-offer-quantity-{{ ai_gen_id }}">
      <button class="ai-quantity-button-{{ ai_gen_id }}" onclick="changeQuantity{{ ai_gen_id }}(-1)">-</button>
      <input
        type="number"
        id="quantity-{{ ai_gen_id }}"
        class="ai-quantity-input-{{ ai_gen_id }}"
        value="1"
        min="1"
        readonly
      >
      <button class="ai-quantity-button-{{ ai_gen_id }}" onclick="changeQuantity{{ ai_gen_id }}(1)">+</button>
    </div>

    {% if block.settings.product_url != blank %}
      <a href="{{ block.settings.product_url }}" class="ai-offer-button-{{ ai_gen_id }}">
        {{ block.settings.button_text | default: 'Add to Cart' }}
      </a>
    {% endif %}

    {% if block.settings.guarantee_text != blank %}
      <div class="ai-offer-guarantee-{{ ai_gen_id }}">{{ block.settings.guarantee_text }}</div>
    {% endif %}

    {% if block.settings.shipping_notice != blank %}
      <div class="ai-offer-shipping-{{ ai_gen_id }}">
        <div>{{ block.settings.shipping_notice }}</div>
        {% if block.settings.countdown_enabled %}
          <div class="ai-countdown-{{ ai_gen_id }}" id="countdown-{{ ai_gen_id }}"></div>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<script>
  (function() {
    window.changeQuantity{{ ai_gen_id }} = function(change) {
      const input = document.getElementById('quantity-{{ ai_gen_id }}');
      const currentValue = parseInt(input.value) || 1;
      const newValue = Math.max(1, currentValue + change);
      input.value = newValue;
    };

    {% if block.settings.countdown_enabled %}
      function startCountdown{{ ai_gen_id }}() {
        const countdownElement = document.getElementById('countdown-{{ ai_gen_id }}');
        if (!countdownElement) return;

        const countdownHours = {{ block.settings.countdown_hours | default: 24 }};
        const endTime = new Date().getTime() + (countdownHours * 60 * 60 * 1000);

        function updateCountdown() {
          const now = new Date().getTime();
          const timeLeft = endTime - now;

          if (timeLeft > 0) {
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

            countdownElement.innerHTML = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
          } else {
            countdownElement.innerHTML = '00:00:00';
          }
        }

        updateCountdown();
        setInterval(updateCountdown, 1000);
      }

      startCountdown{{ ai_gen_id }}();
    {% endif %}
  })();
</script>

{% schema %}
{
  "name": "Blog + Product Offer",
  "settings": [
    {
      "type": "header",
      "content": "Blog content"
    },
    {
      "type": "richtext",
      "id": "blog_text_1",
      "label": "Text block 1",
      "default": "<h2>Welcome to our blog</h2><p>This is the first paragraph of your blog content.</p>"
    },
    {
      "type": "image_picker",
      "id": "blog_image_1",
      "label": "Image 1"
    },
    {
      "type": "richtext",
      "id": "blog_text_2",
      "label": "Text block 2"
    },
    {
      "type": "image_picker",
      "id": "blog_image_2",
      "label": "Image 2"
    },
    {
      "type": "richtext",
      "id": "blog_text_3",
      "label": "Text block 3"
    },
    {
      "type": "image_picker",
      "id": "blog_image_3",
      "label": "Image 3"
    },
    {
      "type": "header",
      "content": "Product offer"
    },
    {
      "type": "text",
      "id": "offer_heading",
      "label": "Offer heading",
      "default": "Special Offer"
    },
    {
      "type": "image_picker",
      "id": "product_image",
      "label": "Product image"
    },
    {
      "type": "text",
      "id": "product_title",
      "label": "Product title",
      "default": "Amazing Product"
    },
    {
      "type": "richtext",
      "id": "benefits_list",
      "label": "Benefits list",
      "default": "<ul><li>High quality materials</li><li>Fast shipping</li><li>30-day guarantee</li></ul>"
    },
    {
      "type": "text",
      "id": "original_price",
      "label": "Original price",
      "default": "$99.99"
    },
    {
      "type": "text",
      "id": "sale_price",
      "label": "Sale price",
      "default": "$79.99"
    },
    {
      "type": "url",
      "id": "product_url",
      "label": "Product URL"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Add to Cart"
    },
    {
      "type": "text",
      "id": "guarantee_text",
      "label": "Guarantee text",
      "default": "30-day money-back guarantee"
    },
    {
      "type": "text",
      "id": "shipping_notice",
      "label": "Shipping notice",
      "default": "Free shipping ends in:"
    },
    {
      "type": "checkbox",
      "id": "countdown_enabled",
      "label": "Enable countdown timer",
      "default": true
    },
    {
      "type": "range",
      "id": "countdown_hours",
      "min": 1,
      "max": 72,
      "step": 1,
      "unit": "h",
      "label": "Countdown duration",
      "default": 24
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "checkbox",
      "id": "sticky_enabled",
      "label": "Enable sticky offer box",
      "default": true
    },
    {
      "type": "range",
      "id": "section_padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Section padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "offer_padding",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Offer box padding",
      "default": 30
    },
    {
      "type": "range",
      "id": "offer_margin",
      "min": 0,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Offer box margin",
      "default": 0
    },
    {
      "type": "range",
      "id": "offer_border_radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Offer box border radius",
      "default": 12
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Image border radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "offer_background_color",
      "label": "Offer background",
      "default": "#fdf2f8"
    },
    {
      "type": "color",
      "id": "primary_text_color",
      "label": "Primary text",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "secondary_text_color",
      "label": "Secondary text",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "highlight_color",
      "label": "Highlight color",
      "default": "#ec4899"
    },
    {
      "type": "color",
      "id": "text_color_black",
      "label": "Blog text black",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color_pink",
      "label": "Blog text pink",
      "default": "#ec4899"
    },
    {
      "type": "color",
      "id": "text_color_grey",
      "label": "Blog text grey",
      "default": "#666666"
    }
  ],
  "presets": [
    {
      "name": "Blog + Product Offer"
    }
  ]
}
{% endschema %}
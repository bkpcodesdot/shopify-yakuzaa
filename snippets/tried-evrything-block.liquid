<div class="tried-everything-section" style="background-color: {{ section.settings.background_color | default: '#ffffff' }};">
  {% for block in section.blocks %}
    {% if block.type == 'tried_everything' %}
      <!-- Tried Everything Block -->
      <style>
        .tried-everything-{{ block.id }} {
          margin-top: {{ block.settings.margin_top }}px;
          margin-bottom: {{ block.settings.margin_bottom }}px;
        }
        .tried-everything-{{ block.id }} .container {
          max-width: {{ block.settings.container_width }}px;
          margin: 0 auto;
          padding: {{ block.settings.section_padding }}px 20px;
        }

        .tried-everything-{{ block.id }} .content-wrapper {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: {{ block.settings.content_gap }}px;
          align-items: center;
        }

        .tried-everything-{{ block.id }} .text-content h2 {
          font-size: {{ section.settings.heading_font_size }}px;
          color: {{ section.settings.heading_color }};
          margin-bottom: {{ block.settings.heading_margin_bottom }}px;
          line-height: 1.2;
          font-weight: {{ block.settings.heading_weight }};
        }

        .tried-everything-{{ block.id }} .items-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: {{ block.settings.items_gap }}px;
        }

        .tried-everything-{{ block.id }} .item {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .tried-everything-{{ block.id }} .bullet {
          width: {{ block.settings.bullet_size }}px;
          height: {{ block.settings.bullet_size }}px;
          background-color: {{ section.settings.point_color }};
          border-radius: 50%;
          flex-shrink: 0;
        }

        .tried-everything-{{ block.id }} .item-text {
          font-size: {{ section.settings.text_font_size }}px;
          color: {{ section.settings.text_color }};
          font-weight: {{ block.settings.item_text_weight }};
          line-height: 1.4;
        }

        .tried-everything-{{ block.id }} .image-content {
          position: relative;
        }

        .tried-everything-{{ block.id }} .image-content img {
          width: 100%;
          height: auto;
          display: block;
          border-radius: {{ block.settings.image_border_radius }}px;
        }

        .tried-everything-{{ block.id }} .x-mark {
          position: absolute;
          width: {{ block.settings.x_mark_size }}px;
          height: {{ block.settings.x_mark_size }}px;
        }

        .tried-everything-{{ block.id }} .x-mark::before,
        .tried-everything-{{ block.id }} .x-mark::after {
          content: '';
          position: absolute;
          width: 100%;
          height: {{ block.settings.x_mark_thickness }}px;
          background-color: {{ block.settings.x_mark_color }};
          top: 50%;
          left: 0;
        }

        .tried-everything-{{ block.id }} .x-mark::before {
          transform: translateY(-50%) rotate(45deg);
        }

        .tried-everything-{{ block.id }} .x-mark::after {
          transform: translateY(-50%) rotate(-45deg);
        }

        @media (max-width: 768px) {
          .tried-everything-{{ block.id }} .content-wrapper {
            grid-template-columns: 1fr;
            gap: 30px;
          }

          .tried-everything-{{ block.id }} .text-content h2 {
            font-size: {{ section.settings.heading_font_size | minus: 8 }}px;
          }

          .tried-everything-{{ block.id }} .items-grid {
            grid-template-columns: 1fr;
          }
        }
      </style>

      <div class="tried-everything-{{ block.id }}" {{ block.shopify_attributes }}>
        <div class="container">
          <div class="content-wrapper">
            <div class="text-content">
              {% if block.settings.heading != blank %}
                <h2>{{ block.settings.heading }}</h2>
              {% endif %}

              <div class="items-grid">
                {% for i in (1..8) %}
                  {% assign item_setting = 'item_' | append: i %}
                  {% if block.settings[item_setting] != blank %}
                    <div class="item">
                      <span class="bullet"></span>
                      <span class="item-text">{{ block.settings[item_setting] }}</span>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>

            <div class="image-content">
              {% if block.settings.main_image != blank %}
                <img 
                  src="{{ block.settings.main_image | image_url: width: 800 }}" 
                  alt="{{ block.settings.heading | default: 'Tried Everything' }}" 
                  loading="lazy"
                  width="800"
                  height="600"
                >
                
                {% if block.settings.show_x_marks %}
                  <span class="x-mark" style="top: {{ block.settings.x_mark_1_top }}%; left: {{ block.settings.x_mark_1_left }}%;"></span>
                  <span class="x-mark" style="top: {{ block.settings.x_mark_2_top }}%; right: {{ block.settings.x_mark_2_right }}%;"></span>
                  <span class="x-mark" style="top: {{ block.settings.x_mark_3_top }}%; left: {{ block.settings.x_mark_3_left }}%;"></span>
                  <span class="x-mark" style="bottom: {{ block.settings.x_mark_4_bottom }}%; right: {{ block.settings.x_mark_4_right }}%;"></span>
                {% endif %}
              {% else %}
                <div style="background: #f0f0f0; padding: 60px 20px; text-align: center; border-radius: 8px;">
                  <p style="color: #999;">Upload an image</p>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>

    {% elsif block.type == 'content_block' %}
      <!-- Content Block -->
      <style>
        .content-block-{{ block.id }} {
          margin-top: {{ block.settings.content_margin_top }}px;
          margin-bottom: {{ block.settings.content_margin_bottom }}px;
          color: {{ block.settings.content_color }};
          font-size: {{ block.settings.content_font_size }}px;
          text-align: {{ block.settings.content_alignment }};
          max-width: 1170px;
          margin-left: auto;
          margin-right: auto;
          padding: 0 20px;
        }
    
        .content-block-{{ block.id }} ul {
          padding: 0 0 0 20px;
        } 
        
        .content-block-{{ block.id }} p {
          margin: 0;
          line-height: 1.6;
        }
      </style>

      <div class="content-block-{{ block.id }}" {{ block.shopify_attributes }}>
        {{ block.settings.content }}
      </div>

    {% elsif block.type == 'organ_supplement' %}
      <!-- Organ Supplement Block -->
      <style>
        .organ-supplement-{{ block.id }} {
          margin-top: 0px;
          margin-bottom: 0px;
          background-color: rgb(255 243 247);
          border: 30px solid #ed1f81;
          border-radius: 8px;
          border-image-source: url('https://cdn.shopify.com/s/files/1/0727/8169/3085/files/food_benefit_bg.webp?v=1759143766');
          padding: 20px;
          max-width: 1170px;
          border-image-slice: 30;
          padding: 0 0 10px;
          margin-left: auto;
          margin-right: auto;
          transition: all 0.3s ease;
          cursor: pointer;
        }

        .organ-supplement-{{ block.id }} .organ-header {
          margin-bottom: 30px;
        }

        .organ-supplement-{{ block.id }} .organ-title {
          {% if block.settings.use_section_colors %}
            color: {{ section.settings.heading_color }};
          {% else %}
            color: {{ block.settings.custom_title_color }};
          {% endif %}
          font-size: {{ block.settings.organ_title_size }}px;
          font-weight: bold;
          margin: 20px 0;
        }

        .organ-supplement-{{ block.id }} .organ-details {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 40px;
          align-items: start;
          margin-top: 30px;
        }

        .organ-supplement-{{ block.id }} .image-text-flex-container {
          display: flex;
          flex-direction: column;
        }

        .organ-supplement-{{ block.id }} .image-text-item {
          display: flex;
          align-items: center;
          gap: 15px;
          padding: 2px 12px;
          border-radius: 8px;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .organ-supplement-{{ block.id }} .organ-point {
          display: flex;
          align-items: flex-start;
          gap: 12px;
          font-size: 20px;
          line-height: 1.5;
          color: #2a2a2a;
          font-weight: 300;
        }

        .organ-supplement-{{ block.id }} .organ-point .icon {
          flex-shrink: 0;
          margin-top: 2px;
          color: white;
          background: #ff699f;
          padding: 3px;
          border-radius: 100%;
          height: 19px;
          width: 19px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .organ-supplement-{{ block.id }} .organ-icon {
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .organ-supplement-{{ block.id }} .organ-icon img {
          max-width: 500px;
          height: auto;
          object-fit: contain;
        }

        @media (max-width: 768px) {
          .organ-supplement-{{ block.id }} .organ-details {
            grid-template-columns: 1fr;
            gap: 30px;
          }
          
          .organ-supplement-{{ block.id }} .image-text-item {
            gap: 12px;
            padding: 10px;
          }
          
          .organ-supplement-{{ block.id }} .organ-point {
            font-size: 16px;
          }
        }
      </style>

      {% if block.settings.organ_link != blank %}
        <a href="{{ block.settings.organ_link }}" class="organ-link" style="text-decoration: none; color: inherit; display: block;">
      {% endif %}

      <div class="organ-supplement-{{ block.id }}" {{ block.shopify_attributes }}>
        <div class="organ-header">
          <h3 class="organ-title">{{ block.settings.organ_name }}</h3>
        </div>
        
        <div class="organ-details">
          <div class="image-text-flex-container">
            {% for i in (1..5) %}
              {% assign text_setting = 'text_' | append: i %}
              {% if block.settings[text_setting] != blank %}
                <div class="image-text-item">
                  <div class="text-container">
                    <div class="organ-point">
                      <span class="icon">
                        <svg width="13" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M1 5.5L5.5 10L15 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </span>
                      {{ block.settings[text_setting] }}
                    </div>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>

          <div class="organ-icon">
            {% if block.settings.organ_icon != blank %}
              <img src="{{ block.settings.organ_icon | img_url: '300x300' }}" alt="{{ block.settings.organ_name }}" loading="lazy" width="300" height="300">
            {% else %}
              <div style="background: #f0f0f0; padding: 40px; text-align: center; border-radius: 8px;">
                <p style="color: #999;">Upload organ icon</p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>

      {% if block.settings.organ_link != blank %}
        </a>
      {% endif %}

    {% elsif block.type == 'problem_section' %}
      <!-- Problem Section Block -->
      <style>
        .problem-section-{{ block.id }} {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 40px 20px;
          max-width: 1170px;
          margin: 0 auto;
        }

        .problem-content-wrapper-{{ block.id }} {
          display: flex;
          gap: 40px;
          flex-wrap: wrap;
          width: 100%;
        }

        .text-side-{{ block.id }} {
          flex: 1 1 50%;
          min-width: 300px;
        }

        .text-side-{{ block.id }} h2 {
          font-size: {{ block.settings.problem_font_size }}px;
          color: {{ block.settings.problem_font_color }};
          margin-bottom: 20px;
        }

        .text-side-{{ block.id }} p {
          font-size: {{ block.settings.text_font_size_one }}px;
          color: #333;
          line-height: 1.6;
          margin-bottom: 15px;
        }

        .image-side-{{ block.id }} {
          flex: 1 1 40%;
        }

        .image-side-{{ block.id }} img {
          width: 100%;
          border-radius: 10px;
          border: 3px solid purple;
        }

        @media (max-width: 768px) {
          .problem-section-{{ block.id }} {
            padding: 20px;
          }
          
          .problem-content-wrapper-{{ block.id }} {
            flex-direction: column;
            gap: 30px;
          }
        }
      </style>

      <div class="problem-section-{{ block.id }}" {{ block.shopify_attributes }}>
        <div class="problem-content-wrapper-{{ block.id }}">
          <div class="text-side-{{ block.id }}">
            {% if block.settings.heading_text != blank %}
              <h2>{{ block.settings.heading_text }}</h2>
            {% endif %}
            
            {% if block.settings.paragraph_text_1 != blank %}
              <p>{{ block.settings.paragraph_text_1 }}</p>
            {% endif %}
            
            {% if block.settings.paragraph_text_2 != blank %}
              <p>{{ block.settings.paragraph_text_2 }}</p>
            {% endif %}
            
            {% if block.settings.bold_text != blank %}
              <p><strong>{{ block.settings.bold_text }}</strong>{{ block.settings.after_bold_text }}</p>
            {% endif %}
          </div>

          <div class="image-side-{{ block.id }}">
            {% if block.settings.image != blank %}
              <img src="{{ block.settings.image | img_url: '600x600' }}" alt="Problem Image" loading="lazy" />
            {% else %}
              <div style="background: #f0f0f0; padding: 60px 20px; text-align: center; border-radius: 10px; border: 3px solid purple;">
                <p style="color: #999;">Upload problem image</p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>

    {% elsif block.type == 'single_capsule' %}
      <!-- Single Capsule Block -->
      <style>
        .single-capsule-{{ block.id }} {
          background-color: {{ block.settings.background_color }};
          color: {{ block.settings.text_color }};
          margin-top: {{ block.settings.margin_top }}px;
          margin-bottom: {{ block.settings.margin_bottom }}px;
          padding: {{ block.settings.padding }}px 20px;
        }

        .single-capsule-{{ block.id }} .capsule-container {
          max-width: 1170px;
          display: flex;
          gap: 40px;
          margin: 0 auto;
        }

        .single-capsule-{{ block.id }} .main-heading {
          display: flex;
          gap: 10px;
          border-bottom: 1px solid #ffc4c4;
          border-top: 1px solid #ffc4c4;
          padding: 15px 0;
          margin-bottom: 20px;
        }

        .single-capsule-{{ block.id }} .capsule-highlight strong {
          color: {{ block.settings.highlight_color }};
        }

        .single-capsule-{{ block.id }} .capsul-image img {
          width: 100%;
          border-radius: 10px;
          border: 5px solid #2f0147;
        }

        .single-capsule-{{ block.id }} .main-heading div {
          font-size: {{ block.settings.main_heading_size }}px;
          font-weight: bold;
          line-height: 1.2;
        }

        .single-capsule-{{ block.id }} .subheading {
          font-size: {{ block.settings.subheading_size }}px;
        }

        .single-capsule-{{ block.id }} .question-text {
          font-size: {{ block.settings.question_size }}px;
          margin-bottom: 10px;
        }

        .single-capsule-{{ block.id }} .answer-text {
          font-size: {{ block.settings.question_size | minus: 4 }}px;
        }

        @media (max-width: 768px) {
          .single-capsule-{{ block.id }} .capsule-container {
            flex-direction: column;
          }
        }
      </style>

      <div class="single-capsule-{{ block.id }}" {{ block.shopify_attributes }}>
        <div class="capsule-container">
          <div class="capsule-content">
            <div class="main-heading">
              {% if block.settings.image_heading != blank %}
                <div class="heading-image">
                  <img src="{{ block.settings.image_heading | img_url: '100x100' }}" alt="Heading icon" loading="lazy" />
                </div>
              {% endif %}
              <div class="heading-box">
                {% if block.settings.main_heading_line1 != blank %}
                  <div>{{ block.settings.main_heading_line1 }}</div>
                {% endif %}
                {% if block.settings.main_heading_line2 != blank %}
                  <div class="capsule-highlight">{{ block.settings.main_heading_line2 }}</div>
                {% endif %}
              </div>
            </div>
            
            {% if block.settings.subheading != blank %}
              <div class="subheading">{{ block.settings.subheading }}</div>
            {% endif %}
            
            <div class="question-section">
              {% if block.settings.question_text != blank %}
                <div class="question-text">{{ block.settings.question_text }}</div>
              {% endif %}
              
              {% if block.settings.answer_text != blank %}
                <div class="answer-text">{{ block.settings.answer_text }}</div>
              {% endif %}
            </div>
          </div>
          
          <div class="capsul-image">
            {% if block.settings.image_capsul != blank %}
              <img src="{{ block.settings.image_capsul | img_url: '600x600' }}" alt="Capsule image" loading="lazy" />
            {% endif %}
          </div>
        </div>
      </div>

    {% elsif block.type == 'superfoods_block' %}
      <!-- Nutrient Card Block -->
      <style>
        .superfoods-section {
          text-align: center;
          padding: 50px 20px;
          max-width: 1200px;
          margin: 0 auto;
        }
        
        .superfood-heading h2 {
          font-size: 28px;
          font-weight: 700;
          margin-bottom: 10px;
          color: #111;
        }
        
        .superfood-heading .subtitle {
          font-size: 16px;
          color: #555;
          margin-bottom: 30px;
        }
        
        .nutrient-rich {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-top: 30px;
        }
        
        .nutrient-card {
          background: #fff;
          border-radius: 16px;
          padding: 20px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          transition: 0.3s;
        }
        
        .nutrient-card:hover {
          transform: translateY(-5px);
        }
        
        .nutrient-title {
          font-size: 18px;
          font-weight: bold;
          margin-bottom: 15px;
        }
        
        .nutrient-images {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
          margin-bottom: 15px;
        }
        
        .nutrient-images img {
          max-width: 80px;
          height: auto;
        }
        
        .vs {
          font-weight: bold;
          font-size: 16px;
          color: #e6007a;
        }
        
        .nutri-bottomline {
          font-size: 14px;
          color: #e6007a;
          font-weight: 500;
        }
      </style>

     <section class="superfoods-section">
  <div class="superfood-heading">
    {% if section.settings.food_heading != blank %}
      <h2>{{ section.settings.food_heading }}</h2>
    {% endif %}
    {% if section.settings.food_subtitle != blank %}
      <div class="subtitle">{{ section.settings.food_subtitle }}</div>
    {% endif %}
  </div>

  <div class="nutrient-rich">
    {% for block in section.blocks %}
      <div class="nutrient-card" {{ block.shopify_attributes }}>
        <div class="nutrient-item">
          <div class="nutrient-title">{{ block.settings.nutrient_heading }}</div>
        </div>

        <div class="nutrient-images">
          {% if block.settings.nutrient_image != blank %}
            <img src="{{ block.settings.nutrient_image | img_url: '300x300' }}" 
                 loading="lazy" 
                 alt="{{ block.settings.nutrient_heading }}">
          {% endif %}

          {% if block.settings.vs_image != blank %}
            <span class="vs">VS</span>
            <img src="{{ block.settings.vs_image | img_url: '300x300' }}" 
                 loading="lazy" 
                 alt="Comparison">
          {% endif %}
        </div>

        {% if block.settings.nutri_bottomline != blank %}
          <div class="nutri-bottomline">{{ block.settings.nutri_bottomline }}</div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</section>

  <primal-queen-hero-{{ ai_gen_id }} class="ai-primal-queen-hero-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-primal-queen-hero-container-{{ ai_gen_id }}">
    <div class="ai-primal-queen-hero-content-{{ ai_gen_id }}">
      <div class="ai-primal-queen-hero-logo-{{ ai_gen_id }}">
        {% if block.settings.logo_image %}
          <img 
            src="{{ block.settings.logo_image | image_url: width: 200 }}" 
            alt="{{ block.settings.logo_text | escape }}"
            class="ai-primal-queen-hero-logo-image-{{ ai_gen_id }}"
            width="200"
            height="auto"
            loading="lazy"
          >
        {% endif %}
        {% if block.settings.logo_text != blank %}
          <span class="ai-primal-queen-hero-logo-text-{{ ai_gen_id }}">{{ block.settings.logo_text }}</span>
        {% endif %}
        {% if block.settings.show_crown_logo %}
          <svg class="ai-primal-queen-hero-crown-{{ ai_gen_id }}" viewBox="0 0 24 24">
            <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm2.7-2h8.6l.9-5.4-2.1 1.7L12 8l-3.1 2.3-2.1-1.7L7.7 14z"/>
          </svg>
        {% endif %}
      </div>
      
      {% if block.settings.attention_text != blank %}
        <div class="ai-primal-queen-hero-attention-{{ ai_gen_id }}">{{ block.settings.attention_text }}</div>
      {% endif %}

      {% if block.settings.main_heading != blank %}
        <h1 class="ai-primal-queen-hero-main-heading-{{ ai_gen_id }}">
          {{ block.settings.main_heading | replace: '[purple]', '<span class="purple-text">' | replace: '[/purple]', '</span>' }}
        </h1>
      {% endif %}

      {% if block.settings.video_url != blank %}
              <div class="ai-primal-queen-hero-media-{{ ai_gen_id }} is-mobile">
      <div class="ai-primal-queen-hero-oval-container-{{ ai_gen_id }}">
        <div class="ai-primal-queen-hero-splatter-{{ ai_gen_id }}"></div>
        <div class="ai-primal-queen-hero-media-content-{{ ai_gen_id }}">
          {% if block.settings.video_url != blank %}
            <video 
              class="ai-primal-queen-hero-video-{{ ai_gen_id }}"
              autoplay
              muted
              loop
              playsinline
            >
              <source src="{{ block.settings.video_url }}" type="video/mp4">
            </video>
          {% elsif block.settings.woman_image %}
            <img 
              src="{{ block.settings.woman_image | image_url: width: 600 }}" 
              alt="Woman drinking water"
              class="ai-primal-queen-hero-woman-image-{{ ai_gen_id }}"
              width="600"
              height="600"
              loading="lazy"
            >
          {% else %}
            <div class="ai-primal-queen-hero-woman-placeholder-{{ ai_gen_id }}">
              {{ 'image' | placeholder_svg_tag }}
            </div>
          {% endif %}
          {% if block.settings.show_one_week_text %}
            <div class="ai-primal-queen-hero-one-week-{{ ai_gen_id }}">{{ block.settings.one_week_text }}</div>
          {% endif %}
        </div>
      </div>
    </div>
    {% endif %}

      {% if block.settings.button_text != blank %}
       <div class="btn_wrapper_wrapper">
        <div class="btn_wrapper">
          <a href="{{ block.settings.button_link }}" class="ai-primal-queen-hero-button-{{ ai_gen_id }}">
            {% if block.settings.show_crown_button %}
              {% comment %} <svg class="ai-primal-queen-hero-button-crown-{{ ai_gen_id }}" viewBox="0 0 24 24">
                <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5zm2.7-2h8.6l.9-5.4-2.1 1.7L12 8l-3.1 2.3-2.1-1.7L7.7 14z"/>
              </svg> {% endcomment %}

              <img src="{{ block.settings.button_crown_icon | image_url }}" class="button_crown_icon" width="20px" height="20px" style="width:20px;">
            {% endif %}
            {{ block.settings.button_text }}
          </a>
        </div>  
      </div>    
      {% endif %}

      <div class="ai-primal-queen-hero-guarantees-{{ ai_gen_id }}">
        {% if block.settings.guarantee_1_text != blank %}
          <div class="ai-primal-queen-hero-guarantee-{{ ai_gen_id }}">
            <svg class="ai-primal-queen-hero-check-{{ ai_gen_id }}" viewBox="0 0 24 24">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
            </svg>
            <span>{{ block.settings.guarantee_1_text }}</span>
          </div>
        {% endif %}
        {% if block.settings.guarantee_2_text != blank %}
          <div class="ai-primal-queen-hero-guarantee-{{ ai_gen_id }}">
            <svg class="ai-primal-queen-hero-check-{{ ai_gen_id }}" viewBox="0 0 24 24">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
            </svg>
            <span>{{ block.settings.guarantee_2_text }}</span>
          </div>
        {% endif %}
      </div>

      <div class="ai-primal-queen-hero-testimonial-section-{{ ai_gen_id }}">
        <div class="ai-primal-queen-hero-testimonial-slider-{{ ai_gen_id }}">
          {% for i in (1..5) %}
            {% liquid
              assign testimonial_text_key = 'testimonial_' | append: i | append: '_text'
              assign testimonial_name_key = 'testimonial_' | append: i | append: '_name'
              assign testimonial_avatar_key = 'testimonial_' | append: i | append: '_avatar'
              assign testimonial_rating_key = 'testimonial_' | append: i | append: '_rating'

              assign testimonial_text = block.settings[testimonial_text_key]
              assign testimonial_name = block.settings[testimonial_name_key]
              assign testimonial_avatar = block.settings[testimonial_avatar_key]
              assign testimonial_rating = block.settings[testimonial_rating_key]
            %}

            {% if testimonial_text != blank and testimonial_name != blank %}
              <div class="ai-primal-queen-hero-testimonial-{{ ai_gen_id }} {% if forloop.first %}active{% endif %}" data-testimonial="{{ forloop.index }}">
                <div class="ai-primal-queen-hero-testimonial-header-{{ ai_gen_id }}">
                  {% if testimonial_avatar %}
                    <img 
                      src="{{ testimonial_avatar | image_url: width: 100 }}" 
                      alt="{{ testimonial_name | escape }}"
                      class="ai-primal-queen-hero-testimonial-avatar-{{ ai_gen_id }}"
                      width="100"
                      height="100"
                      loading="lazy"
                    >
                  {% else %}
                    <div class="ai-primal-queen-hero-testimonial-avatar-placeholder-{{ ai_gen_id }}">
                      {{ 'image' | placeholder_svg_tag }}
                    </div>
                  {% endif %}
                  
                    <div class="right-content-wrapper">
                       <p class="ai-primal-queen-hero-testimonial-text-{{ ai_gen_id }}">{{ testimonial_text }}</p>
                        <div class="ai-primal-queen-hero-testimonial-info-{{ ai_gen_id }}">
                          <h3 class="ai-primal-queen-hero-testimonial-name-{{ ai_gen_id }}">
                            {{ testimonial_name }}
                            {% if block.settings.show_verified_checkmark %}
                              <img src="{{ block.settings.verify_mark_icon | image_url }}" width="17px" height="17px" class="verify_mark_icon">
                            {% endif %}
                          </h3>
                          <div class="ai-primal-queen-hero-testimonial-stars-{{ ai_gen_id }}">
                            {% for star in (1..5) %}
                              <svg class="ai-primal-queen-hero-star-{{ ai_gen_id }}" viewBox="0 0 24 24" {% if star > testimonial_rating %}style="opacity: 0.3;"{% endif %}>
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                              </svg>
                            {% endfor %}
                          </div>
                        </div>
                    </div>

                </div>
                
              </div>
            {% endif %}
          {% endfor %}
        </div>

        <div class="ai-primal-queen-hero-testimonial-dots-{{ ai_gen_id }}">
          {% for i in (1..5) %}
            {% liquid
              assign testimonial_text_key = 'testimonial_' | append: i | append: '_text'
              assign testimonial_name_key = 'testimonial_' | append: i | append: '_name'
              assign testimonial_text = block.settings[testimonial_text_key]
              assign testimonial_name = block.settings[testimonial_name_key]
            %}
            {% if testimonial_text != blank and testimonial_name != blank %}
              <div class="ai-primal-queen-hero-dot-{{ ai_gen_id }} {% if forloop.first %}active{% endif %}" data-dot="{{ forloop.index }}"></div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>

    <div class="ai-primal-queen-hero-media-{{ ai_gen_id }}">
      <div class="ai-primal-queen-hero-oval-container-{{ ai_gen_id }}">
        <div class="ai-primal-queen-hero-splatter-{{ ai_gen_id }}"></div>
        <div class="ai-primal-queen-hero-media-content-{{ ai_gen_id }}">
          {% if block.settings.video_url != blank %}
            <video 
              class="ai-primal-queen-hero-video-{{ ai_gen_id }}"
              autoplay
              muted
              loop
              playsinline
            >
              <source src="{{ block.settings.video_url }}" type="video/mp4">
            </video>
          {% elsif block.settings.woman_image %}
            <img 
              src="{{ block.settings.woman_image | image_url: width: 600 }}" 
              alt="Woman drinking water"
              class="ai-primal-queen-hero-woman-image-{{ ai_gen_id }}"
              width="600"
              height="600"
              loading="lazy"
            >
          {% else %}
            <div class="ai-primal-queen-hero-woman-placeholder-{{ ai_gen_id }}">
              {{ 'image' | placeholder_svg_tag }}
            </div>
          {% endif %}
          {% if block.settings.show_one_week_text %}
            <div class="ai-primal-queen-hero-one-week-{{ ai_gen_id }}">{{ block.settings.one_week_text }}</div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</primal-queen-hero-{{ ai_gen_id }}>
<script>
  (function () {
    class PrimalQueenHero{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.currentTestimonial = 1; // Start at 1 because 0 is the cloned last
        this.testimonials = [];
        this.dots = [];
        this.autoSlideInterval = null;

        // Drag/swipe
        this.isDragging = false;
        this.startX = 0;
        this.movedBy = 0;
      }

      connectedCallback() {
        const slider = this.querySelector('.ai-primal-queen-hero-testimonial-slider-{{ ai_gen_id }}');
        this.originalTestimonials = Array.from(this.querySelectorAll('.ai-primal-queen-hero-testimonial-{{ ai_gen_id }}'));
        this.dots = Array.from(this.querySelectorAll('.ai-primal-queen-hero-dot-{{ ai_gen_id }}'));
        this.testimonialCount = this.originalTestimonials.length;

        // Create wrapper
        let wrapper = slider.querySelector('.ai-primal-queen-hero-testimonial-wrapper-{{ ai_gen_id }}');
        if (!wrapper) {
          wrapper = document.createElement('div');
          wrapper.className = 'ai-primal-queen-hero-testimonial-wrapper-{{ ai_gen_id }}';
          slider.appendChild(wrapper);
        }
        this.wrapper = wrapper;

        // Clone slides for infinite effect
        const firstClone = this.originalTestimonials[0].cloneNode(true);
        const lastClone = this.originalTestimonials[this.testimonialCount - 1].cloneNode(true);

        wrapper.appendChild(firstClone);
        this.originalTestimonials.forEach(t => wrapper.appendChild(t));
        wrapper.insertBefore(lastClone, wrapper.firstChild);

        // Now set full testimonial list including clones
        this.testimonials = Array.from(wrapper.children);

        // Initial position (first actual testimonial)
        this.setWrapperTransition(false);
        this.setTranslateX(this.currentTestimonial);
        this.updateSliderHeight();

        if (this.testimonialCount > 1) {
          this.setupEventListeners();
          this.setupDrag();
          this.startAutoSlide();
        }
      }

      disconnectedCallback() {
        if (this.autoSlideInterval) clearInterval(this.autoSlideInterval);
      }

      setWrapperTransition(enable) {
        this.wrapper.style.transition = enable ? 'transform 0.5s ease-in-out' : 'none';
      }

      setTranslateX(index) {
        const offset = -index * 100;
        this.wrapper.style.transform = `translateX(${offset}%)`;
      }

      showTestimonial(index) {
        this.setWrapperTransition(true);
        this.setTranslateX(index);
        this.currentTestimonial = index;
        this.updateDots();
        this.updateSliderHeight();
      }

      updateDots() {
        const realIndex = (this.currentTestimonial - 1 + this.testimonialCount) % this.testimonialCount;
        this.dots.forEach((d, i) => d.classList.toggle('active', i === realIndex));
      }

      updateSliderHeight() {
        const activeSlide = this.testimonials[this.currentTestimonial];
        const sliderContainer = this.querySelector('.ai-primal-queen-hero-testimonial-slider-{{ ai_gen_id }}');
        if (activeSlide && sliderContainer) {
          const newHeight = activeSlide.offsetHeight;
          sliderContainer.style.height = newHeight + 'px';
        }
      }

      nextTestimonial() {
        if (this.currentTestimonial >= this.testimonialCount) {
          this.showTestimonial(this.currentTestimonial + 1);
          setTimeout(() => {
            this.setWrapperTransition(false);
            this.currentTestimonial = 1;
            this.setTranslateX(this.currentTestimonial);
            this.updateDots();
            this.updateSliderHeight();
          }, 510);
        } else {
          this.showTestimonial(this.currentTestimonial + 1);
        }
      }

      prevTestimonial() {
        if (this.currentTestimonial <= 0) {
          this.showTestimonial(this.currentTestimonial - 1);
          setTimeout(() => {
            this.setWrapperTransition(false);
            this.currentTestimonial = this.testimonialCount;
            this.setTranslateX(this.currentTestimonial);
            this.updateDots();
            this.updateSliderHeight();
          }, 510);
        } else {
          this.showTestimonial(this.currentTestimonial - 1);
        }
      }

      startAutoSlide() {
        this.autoSlideInterval = setInterval(() => {
          this.nextTestimonial();
        }, {{ block.settings.testimonial_auto_slide_duration | times: 10000 }});
      }

      resetAutoSlide() {
        if (this.autoSlideInterval) {
          clearInterval(this.autoSlideInterval);
          this.startAutoSlide();
        }
      }

      setupEventListeners() {
        this.dots.forEach((dot, i) => {
          dot.addEventListener('click', () => {
            this.showTestimonial(i + 1); // Because 0 is the cloned last slide
            this.resetAutoSlide();
          });
        });
      }

      setupDrag() {
        const container = this.querySelector('.ai-primal-queen-hero-testimonial-slider-{{ ai_gen_id }}');

        container.addEventListener('mousedown', this.dragStart.bind(this));
        container.addEventListener('mousemove', this.dragMove.bind(this));
        container.addEventListener('mouseup', this.dragEnd.bind(this));
        container.addEventListener('mouseleave', this.dragEnd.bind(this));

        container.addEventListener('touchstart', this.dragStart.bind(this), { passive: true });
        container.addEventListener('touchmove', this.dragMove.bind(this), { passive: true });
        container.addEventListener('touchend', this.dragEnd.bind(this));
      }

      dragStart(event) {
        this.isDragging = true;
        this.startX = event.type.includes('mouse') ? event.pageX : event.touches[0].clientX;
        this.movedBy = 0;
        this.setWrapperTransition(false);
        this.resetAutoSlide();
      }

      dragMove(event) {
        if (!this.isDragging) return;
        const currentX = event.type.includes('mouse') ? event.pageX : event.touches[0].clientX;
        this.movedBy = currentX - this.startX;

        const percentage = (this.movedBy / this.offsetWidth) * 100;
        const offset = -this.currentTestimonial * 100 + percentage;
        this.wrapper.style.transform = `translateX(${offset}%)`;
      }

      dragEnd() {
        if (!this.isDragging) return;
        this.isDragging = false;
        this.setWrapperTransition(true);

        if (this.movedBy < -50) {
          this.nextTestimonial();
        } else if (this.movedBy > 50) {
          this.prevTestimonial();
        } else {
          this.showTestimonial(this.currentTestimonial); // snap back
        }
      }
    }

    customElements.define('primal-queen-hero-{{ ai_gen_id }}', PrimalQueenHero{{ ai_gen_id }});
  })();
</script>

    {% endif %}
  {% endfor %}
</div>